<%
layout("/layouts/platform.html"){
%>
<header class="header navbar bg-white shadow">
    <div class="btn-group tool-button">
        <a class="btn btn-primary navbar-btn" href="${base}/platform/cms/user" id="goBack" data-pjax><i class="ti-angle-left"></i>${msg['globals.button.back']}</a>
    </div>
</header>

<div class="content-wrap">
    <div class="wrapper" style="min-height:500px;">
        <section class="panel panel-form">
            <form id="editForm" role="form" class="form-horizontal parsley-form" data-parsley-validate
                  action="${base}/platform/cms/user/editDo" method="post">
                <input name="id" type="hidden" value="${obj.id}">
                <div class="row mb10">
                    <div class="col-lg-12">
                        <div class="form-group">
                            <label for="vid" class="col-sm-2 control-label">${msg['cms.user.column.vid']}</label>
                            <div class="col-sm-8">
                                <input type="text" id="vid" class="form-control" name="vid" data-parsley-required="true"
                                       placeholder="${msg['cms.user.column.vid']}" value="${obj.vid}" >
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="username" class="col-sm-2 control-label">${msg['cms.user.column.username']}</label>
                            <div class="col-sm-8">
                                <input type="text" id="username" class="form-control" name="username" data-parsley-required="true"
                                       placeholder="${msg['cms.user.column.username']}" value="${obj.username}"  >
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="headUrl" class="col-sm-2 control-label">${msg['cms.user.column.headUrl']}</label>
                            <div class="col-sm-8">
                                <div id="queue"></div>
                                <div>
                                    <input id="file_upload" name="file_upload" type="file" multiple="false">
                                </div>
                                <div id="img" style="padding: 5px;">
                                    <img src="${obj.headUrl}" alt="">
                                </div>
                                <input type="hidden" id="headUrl" name="headUrl" value="" >
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="password" class="col-sm-2 control-label">${msg['cms.user.column.password']}</label>
                            <div class="col-sm-8">
                                <input type="text" id="password" class="form-control" name="password" data-parsley-required="true"
                                       placeholder="${msg['cms.user.column.password']}" value="${obj.password}"  >
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="email" class="col-sm-2 control-label">${msg['cms.user.column.email']}</label>
                            <div class="col-sm-8">
                                <input type="text" id="email" class="form-control" name="email" data-parsley-required="true"
                                       placeholder="${msg['cms.user.column.email']}" value="${obj.email}"  >
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="contry" class="col-sm-2 control-label">${msg['cms.user.column.contry']}</label>
                            <div class="col-sm-8">
                                <input type="text" id="contry" class="form-control" name="contry" data-parsley-required="true"
                                       placeholder="${msg['cms.user.column.contry']}" value="${obj.contry}"  >
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="realyName" class="col-sm-2 control-label">${msg['cms.user.column.realyName']}</label>
                            <div class="col-sm-8">
                                <input type="text" id="realyName" class="form-control" name="realyName" data-parsley-required="true"
                                       placeholder="${msg['cms.user.column.realyName']}" value="${obj.realyName}"  >
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="cardType" class="col-sm-2 control-label">${msg['cms.user.column.cardType']}</label>
                            <div class="col-sm-8">
                                <select id="cardType" class="form-control" name="cardType" data-parsley-required="true"  >
                                <%for( item in cardtype ){%>
                                <option value = "${item.id}"  ${obj.cardType == item.id?'selected':''}>${item.name}</option>
                                <%}%>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="cardId" class="col-sm-2 control-label">${msg['cms.user.column.cardId']}</label>
                            <div class="col-sm-8">
                                <input type="text" id="cardId" class="form-control" name="cardId" data-parsley-required="true"
                                       placeholder="${msg['cms.user.column.cardId']}" value="${obj.cardId}"  >
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="gender" class="col-sm-2 control-label">${msg['cms.user.column.gender']}</label>
                            <div class="col-sm-8">

                                <input id="gender" name="gender" type="radio" value="0" checked="checked"/>男
                                <input id="gender1" name="gender" type="radio" value="1" />女

                                <!--<input type="text" id="gender" class="form-control" name="gender" data-parsley-required="true"
                                       placeholder="${msg['cms.user.column.gender']}" value="${obj.gender}"  >-->
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="uboth" class="col-sm-2 control-label">${msg['cms.user.column.uboth']}</label>
                            <div class="col-sm-8 input-group date form_datetime "
                                 style="padding-left: 16px;padding-right: 16px;" data-date="1979-09-16T05:25:07Z"
                                 data-date-format="dd MM yyyy - HH:ii p" data-link-field="at">
                                <input type="text" size="16" id="uboth" readonly class="form-control" name="uboth"
                                       data-parsley-required="true" value="${obj.uboth}">
                                <span class="input-group-addon"><span class="glyphicon glyphicon-remove"></span></span>
                                <span class="input-group-addon"><span class="glyphicon glyphicon-th"></span></span>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="ubation" class="col-sm-2 control-label">${msg['cms.user.column.ubation']}</label>
                            <div class="col-sm-8">
                                <input type="text" id="ubation" class="form-control" name="ubation" data-parsley-required="true"
                                       placeholder="${msg['cms.user.column.ubation']}" value="${obj.ubation}"  >
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="placeOforigin" class="col-sm-2 control-label">${msg['cms.user.column.placeOforigin']}</label>
                            <div class="col-sm-8">
                                <input type="text" id="placeOforigin" class="form-control" name="placeOforigin" data-parsley-required="true"
                                       placeholder="${msg['cms.user.column.placeOforigin']}" value="${obj.placeOforigin}"  >
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="mp" class="col-sm-2 control-label">${msg['cms.user.column.mp']}</label>
                            <div class="col-sm-8">
                                <input type="text" id="mp" class="form-control" name="mp" data-parsley-required="true"
                                       placeholder="${msg['cms.user.column.mp']}" value="${obj.mp}"  >
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="tel" class="col-sm-2 control-label">${msg['cms.user.column.tel']}</label>
                            <div class="col-sm-8">
                                <input type="text" id="tel" class="form-control" name="tel" data-parsley-required="true"
                                       placeholder="${msg['cms.user.column.tel']}" value="${obj.tel}"  >
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="qq" class="col-sm-2 control-label">${msg['cms.user.column.qq']}</label>
                            <div class="col-sm-8">
                                <input type="text" id="qq" class="form-control" name="qq" data-parsley-required="true"
                                       placeholder="${msg['cms.user.column.qq']}" value="${obj.qq}"  >
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="weibo" class="col-sm-2 control-label">${msg['cms.user.column.weibo']}</label>
                            <div class="col-sm-8">
                                <input type="text" id="weibo" class="form-control" name="weibo" data-parsley-required="true"
                                       placeholder="${msg['cms.user.column.weibo']}" value="${obj.weibo}"  >
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="region" class="col-sm-2 control-label">${msg['cms.user.column.region']}</label>
                            <div class="col-sm-8">
                                <input type="text" id="region" class="form-control" name="region" data-parsley-required="true"
                                       placeholder="${msg['cms.user.column.region']}" value="${obj.region}"  >
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="address" class="col-sm-2 control-label">${msg['cms.user.column.address']}</label>
                            <div class="col-sm-8">
                                <input type="text" id="address" class="form-control" name="address" data-parsley-required="true"
                                       placeholder="${msg['cms.user.column.address']}" value="${obj.address}"  >
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="youCode" class="col-sm-2 control-label">${msg['cms.user.column.youCode']}</label>
                            <div class="col-sm-8">
                                <input type="text" id="youCode" class="form-control" name="youCode" data-parsley-required="true"
                                       placeholder="${msg['cms.user.column.youCode']}" value="${obj.youCode}"  >
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="political" class="col-sm-2 control-label">${msg['cms.user.column.political']}</label>
                            <div class="col-sm-8">
                                <select id="political" class="form-control" name="political" data-parsley-required="true"  >
                                    <%for( item in political ){%>
                                    <option value = "${item.id}"  ${obj.political == item.id?'selected':''}>${item.name}</option>
                                    <%}%>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="education" class="col-sm-2 control-label">${msg['cms.user.column.education']}</label>
                            <div class="col-sm-8">
                                <select id="education" class="form-control" name="education" data-parsley-required="true"  >
                                    <%for( item in educations ){%>
                                    <option value = "${item.id}"  ${obj.education == item.id?'selected':''}>${item.name}</option>
                                    <%}%>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="employmentStatus" class="col-sm-2 control-label">${msg['cms.user.column.employmentStatus']}</label>
                            <div class="col-sm-8">
                                <select id="employmentStatus" class="form-control" name="employmentStatus" data-parsley-required="true">
                                    <%for( item in employmentStatus ){%>
                                    <option value = "${item.id}"  ${obj.employmentStatus == item.id?'selected':''}>${item.name}</option>
                                    <%}%>
                                </select>
                              <!--  <input type="text" id="employmentStatus" class="form-control" name="employmentStatus" data-parsley-required="true"
                                       placeholder="${msg['cms.user.column.employmentStatus']}" value="${obj.employmentStatus}"  >-->
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="invatToPro" class="col-sm-2 control-label">${msg['cms.user.column.invatToPro']}</label>
                            <div class="col-sm-8">
                                <select id="invatToPro" class="form-control" name="invatToPro" data-parsley-required="true"  >
                                    <%for( item in pros){%>
                                    <option value = "${item.id}" ${obj.invatToPro == item.id?'selected':''}>${item.pname}</option>
                                    <%}%>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="invatToregion" class="col-sm-2 control-label">${msg['cms.user.column.invatToregion']}</label>
                            <div class="col-sm-8">
                                <select id="invatToregion" class="form-control" name="invatToregion" data-parsley-required="true"  >
                                    <%for( item in serviceRegion){%>
                                    <option value = "${item.id}"  ${obj.invatToregion == item.id?'selected':''}>${item.name}</option>
                                    <%}%>

                                </select>
                                <!--<input type="text" id="invatToregion" class="form-control" name="invatToregion" data-parsley-required="true"
                                       placeholder="${msg['cms.user.column.invatToregion']}" value="${obj.invatToregion}"  >-->
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="invatType" class="col-sm-2 control-label">${msg['cms.user.column.invatType']}</label>
                            <div class="col-sm-8">
                                <%
                                for( item in invatType ){
                                var c = false;
                                for(ts in itypes){
                                if(ts == item.id){
                                c = true;
                                }
                                }
                                %>
                                <input type="checkbox" id="invatType" name="invatType"  value=${item.id } ${c?'checked':''} />${item.name}
                                <%

                                }%>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="serviceRegion" class="col-sm-2 control-label">${msg['cms.user.column.serviceRegion']}</label>
                            <div class="col-sm-8">
                                <select id="serviceRegion" class="form-control" name="serviceRegion" data-parsley-required="true"  >
                                    <%for( item in serviceRegion){%>
                                    <option value = "${item.id}"  ${obj.serviceRegion == item.id?'selected':''}>${item.name}</option>
                                    <%}%>

                                </select>
                                <!--<input type="text" id="serviceRegion" class="form-control" name="serviceRegion" data-parsley-required="true"
                                       placeholder="${msg['cms.user.column.serviceRegion']}" value="${obj.serviceRegion}"  >-->
                            </div>
                        </div>
                        <!--<div class="form-group">
                            <label for="authStatus" class="col-sm-2 control-label">${msg['cms.user.column.authStatus']}</label>
                            <div class="col-sm-8">
                                <select id="authStatus" class="form-control" name="authStatus" data-parsley-required="true"  >
                                    <%for( item in authState ){%>
                                    <option value = "${item.id}"  ${obj.authStatus == item.id?'selected':''}>${item.name}</option>
                                    <%}%>
                                </select>
                            </div>
                        </div>-->
                        <!--<div class="form-group">
                            <label for="authReason" class="col-sm-2 control-label">${msg['cms.user.column.authReason']}</label>
                            <div class="col-sm-8">
                                <input type="text" id="authReason" class="form-control" name="authReason" data-parsley-required="true" placeholder="${msg['cms.user.column.authReason']}">
                            </div>
                        </div>-->
                        <div class="form-group">
                            <label for="serviceTime" class="col-sm-2 control-label">${msg['cms.user.column.serviceTime']}</label>
                            <div class="col-sm-8">
                                <input type="text" id="serviceTime" class="form-control" name="serviceTime" data-parsley-required="true"
                                       placeholder="${msg['cms.user.column.serviceTime']}" value="${obj.serviceTime}"  >
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-3"></div>
                <div class="col-lg-6">
                    <div class="form-group text-center">
                        <label></label>

                        <div>
                            <button class="btn btn-primary btn-block btn-lg btn-parsley" data-loading-text="${msg['globals.button.submit.tip']}">${msg['globals.button.submit']}</button>
                        </div>
                    </div>
                </div>
            </form>
        </section>

    </div>
</div>
<script language="JavaScript">
    function clearFile() {
        $("#img").html("");
        $("#queue").html("");
        $("#headUrl").val("");
    }
    $(document).ready(function () {
        $('#file_upload').uploadifive({
            'auto': true,
            'multi': false,
            'width': '100%',
            'height': '35',
            'buttonText': '请选择图片',
            'fileType': 'image/jpg,image/jpeg,image/png',
            'fileSizeLimit': 1024,
            'queueSizeLimit': 1,
            'formData': {},
            'queueID': 'queue',
            'uploadScript': '${base}/open/file/upload/image',
            'onUploadComplete': function (file, data) {
                data = JSON.parse(data);
                if (data.code == 0) {
                    Toast.success(data.msg);
                    $("#img").html("<img src='" + data.data + "' style='width:150px;height:95px;'>");
                    $("#headUrl").val('http://${AppDomain}${base}' + data.data);
                } else {
                    clearFile();
                    Toast.error(data.msg);
                }
            },
            'onDrop': function (file, fileDropCount) {
                clearFile();
            },
            'onClearQueue': function (queue) {
                clearFile();
            },
            'onCancel': function () {
                clearFile();
            }
        });
    });
    $(document).ready(function () {
        $(".form_datetime").datetimepicker({minView: "month", format: 'yyyy-mm-dd',});

        $('#editForm').ajaxForm({
            dataType: 'json',
            beforeSubmit: function (arr, form, options) {
                form.find("button:submit").button("loading");
            },
            success: function (data, statusText, xhr, form) {
                if (data.code == 0) {
                    Toast.success(data.msg);
                    setTimeout(function () {
                        $("#goBack").trigger("click");
                    }, 1000);
                } else {
                    Toast.error(data.msg);
                }
                form.find("button:submit").button("reset");
            }
        });
    });
</script>
<%}%>